<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>__MSG_options.pageTitle__</title>
  <link rel="stylesheet" href="options.css">
  <link rel="stylesheet" href="_locales/rtl.css">
  <script src="i18n.js"></script>
</head>
<body>
  <main class="options-container">
    <header class="options-header">
      <div class="options-title">
        <span class="logo">‚ö°</span>
        <div>
          <h1>__MSG_options.pageTitle__</h1>
          <p class="subtitle">__MSG_options.subtitle__</p>
        </div>
      </div>
      <div class="version" id="extension-version">__MSG_options.versionLabel__</div>
    </header>

    <form id="options-form">
      <section class="options-card">
        <h2>__MSG_options.storageSection__</h2>
        <div class="field">
          <label for="folderPath">__MSG_options.folderPathLabel__</label>
          <input id="folderPath" name="folderPath" type="text" placeholder="__MSG_options.folderPathPlaceholder__">
          <p class="help">__MSG_options.folderPathHelp__</p>
        </div>
        <div class="field">
          <label for="namingPattern">__MSG_options.namingPatternLabel__</label>
          <select id="namingPattern" name="namingPattern">
            <option value="timestamp">__MSG_options.patternTimestamp__</option>
            <option value="firstline">__MSG_options.patternFirstline__</option>
            <option value="custom">__MSG_options.patternCustom__</option>
          </select>
        </div>
        <div class="field hidden" id="custom-pattern-row">
          <label for="customPattern">__MSG_options.customPatternLabel__</label>
          <input id="customPattern" name="customPattern" type="text" placeholder="__MSG_options.customPatternPlaceholder__">
          <p class="help">__MSG_options.tokensHelp__</p>
        </div>

        <!-- Live Filename Preview -->
        <div class="field" id="filename-preview-row">
          <label>__MSG_options.livePreviewLabel__</label>
          <div class="filename-preview" id="filename-preview">
            <span class="preview-folder" id="preview-folder">FlashDocs/</span>
            <span class="preview-filename" id="preview-filename">flashdoc_2026-01-05_1423</span>
            <span class="preview-ext" id="preview-ext">.md</span>
          </div>
          <p class="help">__MSG_options.previewHelp__</p>
        </div>

        <div class="toggle">
          <label for="organizeByType">__MSG_options.organizeByTypeLabel__</label>
          <label class="switch">
            <input id="organizeByType" name="organizeByType" type="checkbox">
            <span class="slider"></span>
          </label>
        </div>
        <div class="section-actions">
          <button type="button" class="btn primary small" data-save-section="storage">__MSG_options.applyBtn__</button>
        </div>
      </section>

      <!-- Sync & Datenschutz Sektion -->
      <section class="options-card">
        <h2>__MSG_options.syncSection__</h2>
        <div class="sync-status-panel">
          <div class="sync-indicator-display" id="sync-status-display">
            <span class="sync-badge synced" id="sync-badge">
              <span class="sync-icon">üîÑ</span>
              <span class="sync-label" id="sync-label">__MSG_options.syncSynced__</span>
            </span>
            <span class="sync-time" id="sync-time">__MSG_options.syncNever__</span>
          </div>
          <div class="sync-actions">
            <button type="button" class="btn secondary small" id="force-sync-btn">__MSG_options.syncNowBtn__</button>
            <button type="button" class="btn secondary small" id="export-sync-btn">__MSG_options.exportSyncBtn__</button>
            <button type="button" class="btn secondary small" id="import-sync-btn">__MSG_options.importSyncBtn__</button>
          </div>
        </div>
        
        <div class="privacy-info-panel">
          <h3>__MSG_options.privacyInfoTitle__</h3>
          <div class="privacy-section">
            <h4>‚úÖ __MSG_options.privacySyncedTitle__</h4>
            <p class="privacy-desc">__MSG_options.privacySyncedDesc__</p>
            <ul class="privacy-keys" id="synced-keys-list">
              <!-- Wird durch JS gef√ºllt -->
            </ul>
          </div>
          <div class="privacy-section">
            <h4>üíæ __MSG_options.privacyLocalTitle__</h4>
            <p class="privacy-desc">__MSG_options.privacyLocalDesc__</p>
            <ul class="privacy-keys" id="local-keys-list">
              <!-- Wird durch JS gef√ºllt -->
            </ul>
          </div>
        </div>
      </section>

      <section class="options-card">
        <h2>__MSG_options.captureSection__</h2>
        <div class="toggle">
          <label for="autoDetectType">__MSG_options.autoDetectLabel__</label>
          <label class="switch">
            <input id="autoDetectType" name="autoDetectType" type="checkbox">
            <span class="slider"></span>
          </label>
        </div>
        <div class="toggle">
          <label for="enableSmartDetection">__MSG_options.highlightLabel__</label>
          <label class="switch">
            <input id="enableSmartDetection" name="enableSmartDetection" type="checkbox">
            <span class="slider"></span>
          </label>
        </div>
        <div class="field">
          <label for="selectionThreshold">__MSG_options.selectionThresholdLabel__</label>
          <div class="range-field">
            <input id="selectionThreshold" name="selectionThreshold" type="range" min="0" max="200" step="5">
            <span class="range-value"><span id="selectionThresholdValue">0</span> __MSG_options.charactersLabel__</span>
          </div>
        </div>
        <div class="section-actions">
          <button type="button" class="btn primary small" data-save-section="capture">__MSG_options.applyBtn__</button>
        </div>
      </section>

      <section class="options-card">
        <h2>__MSG_options.privacySection__</h2>
        <div class="toggle">
          <label for="privacyMode">__MSG_options.privacyModeLabel__</label>
          <label class="switch">
            <input id="privacyMode" name="privacyMode" type="checkbox">
            <span class="slider"></span>
          </label>
        </div>
        <p class="help privacy-help">__MSG_options.privacyHelp__</p>
        <div class="privacy-status" id="privacy-status"></div>
        <div class="section-actions">
          <button type="button" class="btn primary small" data-save-section="privacy">__MSG_options.applyBtn__</button>
        </div>
      </section>

      <section class="options-card">
        <h2>__MSG_options.interfaceSection__</h2>
        <div class="toggle">
          <label for="showFloatingButton">__MSG_options.floatingButtonLabel__</label>
          <label class="switch">
            <input id="showFloatingButton" name="showFloatingButton" type="checkbox">
            <span class="slider"></span>
          </label>
        </div>
        <div class="field" id="button-position-row">
          <label for="buttonPosition">__MSG_options.buttonPositionLabel__</label>
          <select id="buttonPosition" name="buttonPosition">
            <option value="bottom-right">__MSG_options.positionBottomRight__</option>
            <option value="bottom-left">__MSG_options.positionBottomLeft__</option>
            <option value="top-right">__MSG_options.positionTopRight__</option>
            <option value="top-left">__MSG_options.positionTopLeft__</option>
          </select>
        </div>
        <div class="toggle">
          <label for="autoHideButton">__MSG_options.autoHideLabel__</label>
          <label class="switch">
            <input id="autoHideButton" name="autoHideButton" type="checkbox">
            <span class="slider"></span>
          </label>
        </div>
        <div class="toggle">
          <label for="enableContextMenu">__MSG_options.contextMenuLabel__</label>
          <label class="switch">
            <input id="enableContextMenu" name="enableContextMenu" type="checkbox">
            <span class="slider"></span>
          </label>
        </div>
        <div class="section-actions">
          <button type="button" class="btn primary small" data-save-section="interface">__MSG_options.applyBtn__</button>
        </div>
      </section>

      <section class="options-card">
        <h2>__MSG_options.contextMenuSection__</h2>
        <p class="help">__MSG_options.contextMenuHelp__</p>
        <div class="format-grid" id="context-menu-formats"></div>
        <div class="section-actions">
          <button type="button" class="btn primary small" data-save-section="contextmenu">__MSG_options.applyBtn__</button>
        </div>
      </section>

      <!-- v3.1: Contextual Chip Slots Section -->
      <section class="options-card">
        <h2>__MSG_slots.sectionTitle__</h2>
        <p class="help">__MSG_slots.help__</p>

        <!-- Visual Preview of Floating Button -->
        <div class="slot-preview-container">
          <div class="slot-preview-chip">
            <div class="preview-save-bar">
              <span class="preview-logo">‚ö°</span>
              <span class="preview-save-text">Save</span>
              <span class="preview-type-badge">TXT <span class="preview-dropdown-arrow">‚ñº</span></span>
            </div>
            <div class="preview-slot-buttons" id="preview-slot-buttons">
              <div class="preview-slot" data-slot="0">üìÑ</div>
              <div class="preview-slot" data-slot="1">üìù</div>
              <div class="preview-slot" data-slot="2">üìú</div>
              <div class="preview-slot" data-slot="3">üìï</div>
              <div class="preview-slot" data-slot="4">üìÅ</div>
            </div>
          </div>
          <!-- Slot Dropdowns directly below each button -->
          <div class="slot-dropdowns-row" id="slots-config">
            <!-- Dynamically populated by options.js -->
          </div>
        </div>

        <!-- Preset Management -->
        <div class="preset-section">
          <h3>__MSG_slots.presetSection__</h3>
          <p class="help preset-help">__MSG_slots.presetHelp__</p>

          <!-- Active Preset Indicator -->
          <div class="active-preset-indicator" id="active-preset-indicator">
            <span class="indicator-label">__MSG_slots.activeIndicator__</span>
            <span class="indicator-name" id="active-preset-name">__MSG_slots.noneActive__</span>
          </div>

          <div class="preset-toolbar">
            <select id="preset-selector" class="preset-select">
              <option value="">__MSG_slots.selectPreset__</option>
            </select>
            <button type="button" class="btn primary small" id="preset-apply" title="__MSG_slots.applyPreset__">__MSG_slots.applyPreset__</button>
          </div>

          <div class="preset-actions">
            <button type="button" class="btn secondary small" id="preset-new" title="__MSG_slots.newPreset__">__MSG_slots.newPreset__</button>
            <button type="button" class="btn secondary small" id="preset-save" title="__MSG_slots.savePreset__">__MSG_slots.savePreset__</button>
            <button type="button" class="btn danger small" id="preset-delete" title="__MSG_slots.deletePreset__">__MSG_slots.deletePreset__</button>
          </div>
          
          <div class="preset-import-export">
            <button type="button" class="btn icon small" id="preset-export" title="__MSG_slots.exportPreset__">üì§ __MSG_slots.exportPreset__</button>
            <button type="button" class="btn icon small" id="preset-import" title="__MSG_slots.importPreset__">üì• __MSG_slots.importPreset__</button>
            <button type="button" class="btn icon small" id="preset-share" title="__MSG_slots.sharePreset__">üîó __MSG_slots.sharePreset__</button>
          </div>
          
          <!-- Import Modal -->
          <dialog id="import-modal" class="modal">
            <div class="modal-content">
              <h3>__MSG_slots.importTitle__</h3>
              <textarea id="import-textarea" placeholder="__MSG_slots.importPlaceholder__" rows="6"></textarea>
              <div class="modal-actions">
                <button type="button" class="btn secondary" id="import-cancel">__MSG_slots.cancelBtn__</button>
                <button type="button" class="btn primary" id="import-confirm">__MSG_slots.confirmImport__</button>
              </div>
            </div>
          </dialog>
          
          <!-- Export/Share Modal -->
          <dialog id="export-modal" class="modal">
            <div class="modal-content">
              <h3 id="export-modal-title">__MSG_slots.exportTitle__</h3>
              <textarea id="export-textarea" readonly rows="6"></textarea>
              <div class="modal-actions">
                <button type="button" class="btn secondary" id="export-close">__MSG_slots.closeBtn__</button>
                <button type="button" class="btn primary" id="export-copy">__MSG_slots.copyBtn__</button>
              </div>
            </div>
          </dialog>

          <span class="preset-count" id="preset-count">__MSG_slots.presetCount__</span>
        </div>
      </section>

      <!-- Category Shortcuts Section -->
      <section class="options-card">
        <h2>__MSG_shortcuts.sectionTitle__</h2>
        <p class="help">__MSG_shortcuts.help__</p>

        <!-- Add new shortcut form -->
        <div class="shortcut-add-form">
          <input type="text" id="new-shortcut-name" placeholder="__MSG_shortcuts.namePlaceholder__" maxlength="20">
          <select id="new-shortcut-format">
            <option value="md">.md</option>
            <option value="txt">.txt</option>
            <option value="docx">.docx</option>
            <option value="pdf">.pdf</option>
            <option value="json">.json</option>
            <option value="js">.js</option>
            <option value="py">.py</option>
            <option value="html">.html</option>
            <option value="css">.css</option>
            <option value="yaml">.yaml</option>
          </select>
          <button type="button" class="btn primary small" id="add-shortcut">__MSG_shortcuts.addBtn__</button>
        </div>

        <!-- Existing shortcuts list -->
        <div class="shortcut-list" id="shortcut-list"></div>
        <div class="shortcut-footer">
          <span class="shortcut-count" id="shortcut-count">__MSG_shortcuts.shortcutCount__</span>
        </div>
      </section>

      <!-- F3: Corner Ball Section -->
      <section class="options-card">
        <h2>__MSG_options.cornerBallSection__</h2>
        <p class="help">__MSG_options.cornerBallHelp__</p>
        <div class="toggle">
          <label for="showCornerBall">__MSG_options.cornerBallLabel__</label>
          <label class="switch">
            <input id="showCornerBall" name="showCornerBall" type="checkbox">
            <span class="slider"></span>
          </label>
        </div>
        <div class="section-actions">
          <button type="button" class="btn primary small" data-save-section="cornerball">__MSG_options.applyBtn__</button>
        </div>
      </section>

      <section class="options-card">
        <h2>__MSG_options.feedbackSection__</h2>
        <div class="toggle">
          <label for="showNotifications">__MSG_options.notificationsLabel__</label>
          <label class="switch">
            <input id="showNotifications" name="showNotifications" type="checkbox">
            <span class="slider"></span>
          </label>
        </div>
        <div class="toggle">
          <label for="playSound">__MSG_options.soundLabel__</label>
          <label class="switch">
            <input id="playSound" name="playSound" type="checkbox">
            <span class="slider"></span>
          </label>
        </div>
        <div class="section-actions">
          <button type="button" class="btn primary small" data-save-section="feedback">__MSG_options.applyBtn__</button>
        </div>
      </section>

      <section class="options-card">
        <h2>__MSG_options.trackingSection__</h2>
        <p class="help">__MSG_options.trackingHelp__</p>

        <div class="toggle">
          <label for="trackFormatUsage">__MSG_options.trackFormatUsageLabel__</label>
          <label class="switch">
            <input id="trackFormatUsage" name="trackFormatUsage" type="checkbox" checked>
            <span class="slider"></span>
          </label>
        </div>

        <div class="toggle">
          <label for="trackDetectionAccuracy">__MSG_options.trackAccuracyLabel__</label>
          <label class="switch">
            <input id="trackDetectionAccuracy" name="trackDetectionAccuracy" type="checkbox" checked>
            <span class="slider"></span>
          </label>
        </div>

        <div class="toggle">
          <label for="showFormatRecommendations">__MSG_options.recommendationsLabel__</label>
          <label class="switch">
            <input id="showFormatRecommendations" name="showFormatRecommendations" type="checkbox" checked>
            <span class="slider"></span>
          </label>
        </div>

        <div class="recommendations-panel" id="recommendations-panel">
          <h3>__MSG_options.recommendationsTitle__</h3>
          <div class="recommendations-list" id="recommendations-list">
            <div class="recommendation-item">
              <span class="rec-icon">üí°</span>
              <div class="rec-content">
                <strong>__MSG_options.loadingRecommendations__</strong>
              </div>
            </div>
          </div>
        </div>
        <div class="section-actions">
          <button type="button" class="btn primary small" data-save-section="tracking">__MSG_options.applyBtn__</button>
        </div>
      </section>

      <section class="options-actions">
        <div class="status" id="status-message" role="status" aria-live="polite"></div>
        <div class="buttons">
          <button type="button" class="btn secondary" id="reset-defaults">__MSG_options.resetDefaults__</button>
        </div>
      </section>
    </form>
  </main>

  <script src="sync-manager.js"></script>
  <script src="options.js"></script>
</body>
</html>
